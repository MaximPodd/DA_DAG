# –°–∏—Å—Ç–µ–º–∞ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–µ—Ç—Ä–∏–∫ –≤ Airflow

–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∞–ª–µ—Ä—Ç–æ–≤ –¥–ª—è –∫–ª—é—á–µ–≤—ã—Ö –º–µ—Ç—Ä–∏–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, —Ä–∞–±–æ—Ç–∞—é—â–∞—è –Ω–∞ Apache Airflow.

## –û–ø–∏—Å–∞–Ω–∏–µ

–°–∏—Å—Ç–µ–º–∞ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –æ—Å–Ω–æ–≤–Ω—ã–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –∞–ª–µ—Ä—Ç—ã –≤ Telegram –ø—Ä–∏ –æ–±–Ω–∞—Ä—É–∂–µ–Ω–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π.

### –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ä—É–µ–º—ã–µ –º–µ—Ç—Ä–∏–∫–∏:
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –ª–µ–Ω—Ç—ã
- –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–µ—Å—Å–µ–Ω–¥–∂–µ—Ä–∞  
- –ü—Ä–æ—Å–º–æ—Ç—Ä—ã
- –õ–∞–π–∫–∏
- CTR (Click-Through Rate)
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª

- üïí **–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫**: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∫–∞–∂–¥—ã–µ 15 –º–∏–Ω—É—Ç
- üìä **–î–µ—Ç–µ–∫—Ü–∏—è –∞–Ω–æ–º–∞–ª–∏–π**: –°—Ç–∞—Ç–∏—Å—Ç–∏—á–µ—Å–∫–∏–π –º–µ—Ç–æ–¥ IQR
- üîî **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è**: –û—Ç–ø—Ä–∞–≤–∫–∞ –≤ Telegram-—á–∞—Ç
- üìà **–í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è**: –ì—Ä–∞—Ñ–∏–∫–∏ —Å –≤—ã–¥–µ–ª–µ–Ω–∏–µ–º –∞–Ω–æ–º–∞–ª–∏–π
- üîó **–°—Å—ã–ª–∫–∏**: –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ –¥–∞—à–±–æ—Ä–¥–∞–º –≤ BI

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –¥–µ—Ç–∞–ª–∏

### –ú–µ—Ç–æ–¥ –¥–µ—Ç–µ–∫—Ü–∏–∏ –∞–Ω–æ–º–∞–ª–∏–π

–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –º–µ—Ç–æ–¥ –º–µ–∂–∫–≤–∞—Ä—Ç–∏–ª—å–Ω–æ–≥–æ —Ä–∞–∑–º–∞—Ö–∞ (IQR) —Å –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ–º—ã–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:
- `a`: –ú–Ω–æ–∂–∏—Ç–µ–ª—å IQR (–æ–±—ã—á–Ω–æ 2.5-4)
- `n`: –†–∞–∑–º–µ—Ä –æ–∫–Ω–∞ –¥–ª—è —Ä–∞—Å—á–µ—Ç–æ–≤ (–æ–±—ã—á–Ω–æ 5-10)

–ê–ª–µ—Ä—Ç —Å—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç –ø—Ä–∏ –≤—ã—Ö–æ–¥–µ –∑–Ω–∞—á–µ–Ω–∏—è –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã:
- –í–µ—Ä—Ö–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ = Q3 + a*IQR
- –ù–∏–∂–Ω—è—è –≥—Ä–∞–Ω–∏—Ü–∞ = Q1 - a*IQR

### –ü–∞–π–ø–ª–∞–π–Ω –¥–∞–Ω–Ω—ã—Ö

1. –ó–∞–±–æ—Ä –¥–∞–Ω–Ω—ã—Ö –∏–∑ ClickHouse
2. –ê–Ω–∞–ª–∏–∑ –º–µ—Ç—Ä–∏–∫ –∑–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–µ 48 —á–∞—Å–æ–≤  
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –∞–Ω–æ–º–∞–ª–∏–∏
4. –§–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∞–ª–µ—Ä—Ç–æ–≤

### –§–æ—Ä–º–∞—Ç –∞–ª–µ—Ä—Ç–∞

–ö–∞–∂–¥—ã–π –∞–ª–µ—Ä—Ç —Å–æ–¥–µ—Ä–∂–∏—Ç:
- –ù–∞–∑–≤–∞–Ω–∏–µ –º–µ—Ç—Ä–∏–∫–∏ –∏ —Ç–µ–∫—É—â–µ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
- –ü—Ä–æ—Ü–µ–Ω—Ç –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏—è
- –°—Å—ã–ª–∫–∏ –Ω–∞ –¥–∞—à–±–æ—Ä–¥—ã
- –ì—Ä–∞—Ñ–∏–∫ —Å —Ç—Ä–µ–Ω–¥–æ–º –∏ –∞–Ω–æ–º–∞–ª–∏—è–º–∏

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –º–µ—Ç—Ä–∏–∫ –≤ —Å–ª–æ–≤–∞—Ä–µ `metrics_params`:
```python
metrics_params = {
    'views': {'a':3, 'n':7, 'url':'http://example.com/views', 'name':'–ü—Ä–æ—Å–º–æ—Ç—Ä—ã'},
    # –¥—Ä—É–≥–∏–µ –º–µ—Ç—Ä–∏–∫–∏...
}

## –ü—Ä–∏–º–µ—Ä –∞–ª–µ—Ä—Ç–∞
![IMG_20250722_234312](https://github.com/user-attachments/assets/dd7eef8c-36e1-4de7-b41a-a3e3a08fe1bd)
